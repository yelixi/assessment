<!DOCTYPE html>
<!--试卷新增页面-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>试卷创建</title>
		<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css">
		<link href="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css"
		      rel="stylesheet">

		<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
		<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<!--DateTimepicker-->
		<script src="https://cdn.bootcss.com/moment.js/2.18.1/moment-with-locales.min.js"></script>
		<script src="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
		<!--BootStrap Table-->
		<script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>
	</head>
	<body>
		<nav th:replace="../static/html/common/fragments.html::issuer_menu(3)"></nav>

		<div class="container">
			<form class="form" method="post" role="form">
				<h1 id="add-title">创建一场考试</h1>
				<br>
				<div class="form-group">
					<label for="exam-name">考试名称</label>
					<input type="text" id="exam-name" class="form-control" placeholder="这里什么都没有" required autofocus>
				</div>
				<div class="form-group">
					<label for="exam-start-time">开始时间</label>
					<div class='input-group date form-date form_datetime' id='exam-start-time'>
						<input type='text' class="form-control" id="start_time"/>
						<span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
					</div>
				</div>
				<div class="form-group">
					<label for="exam-end-time">结束时间</label>
					<!--指定 date标记-->
					<div class='input-group date' id='exam-end-time'>
						<input type='text' class="form-control" id="end_time"/>
						<span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
					</div>
				</div>
				<input name="_csrf" type="hidden" value="93edbebc-aa90-4b8c-b372-28f922a9a9e6"/>
				<button class="btn btn-lg btn-primary btn-block" type="button" id="exam-update-btn" onclick="update()">
					保存问题
				</button>
			</form>
		</div>


	</body>
	<script>
        //更新函数
        function update() {
            var st = $("#start_time").val();
            var et = $("#end_time").val();
            let formData = JSON.stringify({
                "name": $("#exam-name").val(),
                "questions": [],
                "startTime": $("#start_time").val(),
                "endTime": $("#end_time").val()
            });
            $.ajax({
                url: "/issuer/createExam",
                type: "post",
                contentType: "application/json",
                data: formData,
                dataType: "json"
            }).done(function (result) {
                if (result.code == 200) {
                    alert("保存试卷成功,赶紧去为考试添加问题吧!");
                    location.reload();
                    location.href = "/issuer/updateExam/" + result.data.id;
                } else alert("添加试卷失败!！");
            })
        }


        $('#exam-start-time').datetimepicker({
            format: 'YYYY-MM-DD hh:mm:ss',
            locale: moment.locale('zh-cn')
        });
        $('#exam-end-time').datetimepicker({
            format: 'YYYY-MM-DD hh:mm:ss',
            locale: moment.locale('zh-cn')
        });


	</script>
</html>
