<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>用户管理</title>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
		<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
		<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>
	<body>
		<nav th:replace="../static/html/common/fragments.html::root_menu(2)"></nav>
		<div class="container" >
			<form method="post" role="form" action="/root/register">
				<h2 class="form-signin-heading">新增用户</h2>
				<p>
					<label for="username" class="sr-only">Username</label>
					<input type="text" id="username" name="username" class="form-control" placeholder="Username" required autofocus>
				</p>
				<p>
					<label for="password" class="sr-only">Password</label>
					<input type="password" id="password" name="password" class="form-control" placeholder="Password" required>
				</p>
				<p>
					<label for="role" class="sr-only">role</label>
					<select id="role" name="role" class="form-control ">
						<option value="ROOT">超级用户</option>
						<option value="CORRECTOR">批改人员</option>
						<option value="ISSUER">管理人员</option>
						<option value="MEMBER">普通人员</option>
					</select>
				</p>
				<input name="_csrf" type="hidden" value="93edbebc-aa90-4b8c-b372-28f922a9a9e6" />
				<button class="btn btn-lg btn-primary btn-block" type="button" id="btn">注册</button>
				<button class="btn btn-lg btn-primary btn-block" type="button" id="registerAll">批量注册</button>
			</form>

		</div>
	</body>
	<script>
        $("#btn").click(function (){
            let formData = JSON.stringify({
                "username":$("#username").val(),
                "password":$("#password").val(),
                "role":$("#role").val()
            })
            $.ajax({
                url:"/root/register",
                type:"post",
                contentType:"application/json",
                data:formData,
                dataType:"json"
            }).done(function (data){
                if(data.code===200) {
                    alert("注册成功")
                    $("#username").val("")
                    $("#password").val("")
                    $("#role").val("")
                }
                else
                    alert(data.message)
            })
        })
		$("#registerAll").click(function (){
			window.location.href="/root/registerAll";
		})
	</script>
</html>
